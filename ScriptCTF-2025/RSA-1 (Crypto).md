> Yú Tóngyī send a message to 3 peoples with unique modulus. But he left it vulnerable. Figure out :)
> 
> Attachments
>
> out.txt
>
> contenant : 
> n1 = 156503881374173899106040027210320626006530930815116631795516553916547375688556673985142242828597628615920973708595994675661662789752600109906259326160805121029243681236938272723595463141696217880136400102526509149966767717309801293569923237158596968679754520209177602882862180528522927242280121868961697240587
> 
> c1 = 77845730447898247683281609913423107803974192483879771538601656664815266655476695261695401337124553851404038028413156487834500306455909128563474382527072827288203275942719998719612346322196694263967769165807133288612193509523277795556658877046100866328789163922952483990512216199556692553605487824176112568965
> 
> n2 = 81176790394812943895417667822424503891538103661290067749746811244149927293880771403600643202454602366489650358459283710738177024118857784526124643798095463427793912529729517724613501628957072457149015941596656959113353794192041220905793823162933257702459236541137457227898063370534472564804125139395000655909
> 
> c2 = 40787486105407063933087059717827107329565540104154871338902977389136976706405321232356479461501507502072366720712449240185342528262578445532244098369654742284814175079411915848114327880144883620517336793165329893295685773515696260299308407612535992098605156822281687718904414533480149775329948085800726089284
> 
> n3 = 140612513823906625290578950857303904693579488575072876654320011261621692347864140784716666929156719735696270348892475443744858844360080415632704363751274666498790051438616664967359811895773995052063222050631573888071188619609300034534118393135291537302821893141204544943440866238800133993600817014789308510399
> 
> c3 = 100744134973371882529524399965586539315832009564780881084353677824875367744381226140488591354751113977457961062275480984708865578896869353244823264759044617432862876208706282555040444253921290103354489356742706959370396360754029015494871561563778937571686573716714202098622688982817598258563381656498389039630
> 
> e = 3

Attaque sur RSA quand un message est chiffré avec le même exposant public (e=3) mais avec trois modules différents.

Dans RSA, le ciphertext  c=m^e mod n.

Ici, on a 3 modules distincts, 3 ciphertexts correspondant au même message m chiffré avec e=3.

Attaque Possible : Hastad’s Broadcast Attack (low exponent)
Quand on a le même message chiffré avec un petit exposant public e (ici e=3) sur plusieurs modules différents, on peut utiliser l'attaque de Hastad (en combinant les ciphertexts via le théorème des restes chinois) pour récupérer m sans factoriser les modules.

Étapes faites : 
1. Appliquer le théorème des restes chinois (CRT) pour combiner c1, c2, c3 avec n1, n2, n3 dans un modulo N = n1×n2×n3

2. Obtenir C=m^3 mod N à partir des trois ci

3. Sous l'hypothèse que m^3<N, le résultat C=m^3 sans modulo (car pas de dépassement)

4. Calculer la racine cubique entière de C pour retrouver m

Code Python avec lecture des valeurs et calcul de la racine cubique pour récupérer le message : 
```
from sympy.ntheory.modular import crt
from decimal import Decimal, getcontext

# Valeurs données
n1 = 156503881374173899106040027210320626006530930815116631795516553916547375688556673985142242828597628615920973708595994675661662789752600109906259326160805121029243681236938272723595463141696217880136400102526509149966767717309801293569923237158596968679754520209177602882862180528522927242280121868961697240587
c1 = 77845730447898247683281609913423107803974192483879771538601656664815266655476695261695401337124553851404038028413156487834500306455909128563474382527072827288203275942719998719612346322196694263967769165807133288612193509523277795556658877046100866328789163922952483990512216199556692553605487824176112568965
n2 = 81176790394812943895417667822424503891538103661290067749746811244149927293880771403600643202454602366489650358459283710738177024118857784526124643798095463427793912529729517724613501628957072457149015941596656959113353794192041220905793823162933257702459236541137457227898063370534472564804125139395000655909
c2 = 40787486105407063933087059717827107329565540104154871338902977389136976706405321232356479461501507502072366720712449240185342528262578445532244098369654742284814175079411915848114327880144883620517336793165329893295685773515696260299308407612535992098605156822281687718904414533480149775329948085800726089284
n3 = 140612513823906625290578950857303904693579488575072876654320011261621692347864140784716666929156719735696270348892475443744858844360080415632704363751274666498790051438616664967359811895773995052063222050631573888071188619609300034534118393135291537302821893141204544943440866238800133993600817014789308510399
c3 = 100744134973371882529524399965586539315832009564780881084353677824875367744381226140488591354751113977457961062275480984708865578896869353244823264759044617432862876208706282555040444253921290103354489356742706959370396360754029015494871561563778937571686573716714202098622688982817598258563381656498389039630
e = 3

# Combine using CRT
C, N = crt([n1, n2, n3], [c1, c2, c3])

# Obtenir m^e mod N, assuming m^3 < N, et m^3 sans modulo

# Calcul racines cubiques de C
def integer_cuberoot(x):
    low, high = 0, x
    while low < high:
        mid = (low + high) // 2
        if mid**3 < x:
            low = mid + 1
        else:
            high = mid
    return low

m = integer_cuberoot(C)
print("Message (integer):", m)

# Conversion into ASCII
hex_m = hex(m)[2:]  # Remove '0x'
if len(hex_m) % 2:
    hex_m = '0' + hex_m
msg_bytes = bytes.fromhex(hex_m)
flag = msg_bytes.decode('utf-8', errors='ignore')
print("Flag:", flag)
```

<details>
<summary>Flag</summary>

scriptCTF{y0u_f0und_mr_yu's_s3cr3t_m3g_12a4e4}

</details>
